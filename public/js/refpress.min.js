/*! 
 * RefPress JavaScript Library 
 * @package RefPress 
 */
window.RefPress=window.RefPress||{},jQuery(document).ready(function(e){"use strict";RefPress.chartdata={start:function(){"undefined"!=typeof Chart&&Chart&&this.chartInit()},chartInit:function(){var e,s,t=document.getElementById("RefPressChartCanvas");!t||(e=t.getAttribute("data-chartvalue"))&&(s=JSON.parse(e),t=t.getContext("2d"),new Chart(t,{type:"line",data:{labels:s.labels,datasets:[{label:"Amount",backgroundColor:"rgba(219,173,201,0.4)",borderColor:"#9B2B69",data:s.value,borderWidth:2,fill:!0,lineTension:0}]},options:{tooltips:{callbacks:{label:function(e,t){return t.datasets[e.datasetIndex].label+" : "+_refpress.currency_sign+e.yLabel}}},scales:{xAxes:[{ticks:{callback:function(e,t,r){return s.xAxes&&s.xAxes[t]?s.xAxes[t]:e}}}],yAxes:[{ticks:{min:0,beginAtZero:!0,callback:function(e,t,r){if(Math.floor(e)===e)return _refpress.currency_sign+e}}}]},legend:{display:!1}}}))}},RefPress.chartdata.start()}),window.RefPress=window.RefPress||{},jQuery(document).ready(function(s){"use strict";RefPress.core={start:function(){this.pluginInit(),this.addListeners(),this.loadEvents(),this.create_account_search_wp_user()},pluginInit:function(){jQuery.datepicker&&s(".refpress_datepicker").datepicker({dateFormat:"yy-mm-dd"}),void 0!==s.fn.wpColorPicker&&s(".refpress_color_picker").wpColorPicker(),jQuery().select2&&s(".refpress_select2").select2()},addListeners:function(){s(document).on("submit","#refpressLinkGeneratorForm",this.generateAffiliateLink.bind(this)),s(document).on("click","#refpressCopyLinkSelector",this.copyLink.bind(this)),s(document).on("click",".refpress-admin-payout-nav-method-item",this.payoutSettingsTabToggle.bind(this)),s(document).on("change","#refpress_payout_method_select",this.switchPayoutMethod.bind(this))},loadEvents:function(){s(document).on("click",".refpress-settings-sidebar a",function(e){e.preventDefault();e=s(this).attr("data-target");s(".option-sidebar-item").removeClass("current"),s(this).addClass("current"),s(".refpress-settings-panel-nav_tab").hide(),s(e).addClass("current").show(),window.history.pushState("obj","",s(this).attr("href"))}),s(document).on("change","#RefPressSettingsForm",function(e){s("#refpress-settings-panel-notice-wrap").html('<p class="settings-changes-warning"><strong>'+_refpress.settings_changed_msg+"</strong></p>")}),s(document).on("submit","#RefPressSettingsForm",function(e){e.preventDefault();var t=s(this),e=t.serialize();s.ajax({url:_refpress.ajaxurl,type:"POST",data:e,beforeSend:function(){s("#refpress-settings-panel-notice-wrap").html(""),t.find(".button").addClass("refpress-spinner")},complete:function(){t.find(".button").removeClass("refpress-spinner")}})})},generateAffiliateLink:function(e){e.preventDefault();s(e.currentTarget);var t=s("#landing-page-url-input").val().trim(),r=s("#refpress-campaign-input").val().trim(),e="";0<t.length&&(e=RefPress.updateQueryStringParameter(t,_refpress.ref_param,_refpress.current_user_id),0<r.length&&(e=RefPress.updateQueryStringParameter(e,"campaign",r))),s("#repressGeneratedLink").val(e),s("#refpressGeneratorlinkWrap").show()},copyLink:function(e){e.preventDefault();var t=s(e.target),e=document.getElementById("repressGeneratedLink");e.select(),e.setSelectionRange(0,99999),document.execCommand("copy"),t.html(_refpress.copied)},create_account_search_wp_user:function(){var t;function r(){var e=s("#reppress_wp_user_name").val().trim();s.ajax({url:_refpress.ajaxurl,type:"POST",data:{search_term:e,action:"refpress_create_account_search_wp_user"},success:function(e){s("#refpress-account-search-results").html(e.data.results)},complete:function(){}})}s(document).on("keyup change paste","#reppress_wp_user_name",function(){var e=s(this).val().trim();if(e===(s(this).attr("data-curr_val")?s(this).attr("data-curr_val").trim():null))return!1;s(this).attr("data-curr_val",e),3<=e.length?s("#refpress-account-search-results").html('<p class="searching-text"> '+_refpress.searching_user+" </p>"):s("#refpress-account-search-results").html(""),clearTimeout(t),3<=e.length&&(t=setTimeout(r,2e3))}),s(document).on("click",".choose-user-to-create-account",function(e){e.preventDefault();var t=s(this),e=t.attr("data-user-id").trim(),t=t.attr("data-user-fullname").trim();s("#refpress_wp_user_id").val(e),s("#reppress_wp_user_name").val(t),s("#refpress-account-search-results").html("")})},payoutSettingsTabToggle:function(e){e.preventDefault();e=s(e.target).attr("data-target-id");s(".refpress-settings-payout-method-content").hide(),s("#"+e).show()},switchPayoutMethod:function(e){e.preventDefault();e=s(e.target).val();s(".payout-method-form-wrap").hide(),s("#payout-method-form-"+e).show()}},RefPress.core.start()}),window.RefPress=window.RefPress||{},jQuery(document).ready(function(e){"use strict";RefPress.updateQueryStringParameter=function(e,t,r){var s=new RegExp("([?&])"+t+"=.*?(&|$)","i"),a=-1!==e.indexOf("?")?"&":"?",n=null;if(n=e.match(s)?e.replace(s,"$1"+t+"="+r+"$2"):e+a+t+"="+r)return encodeURI(n)}});